<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">


<sqlMap namespace="Qblo102x_01DAO">

    <typeAlias alias="Qblo102x_01DAO.LnRpymDscrRsltVo" type="efc.b.lo.rm.vo.LnRpymDscrRsltVo" />

    <select id="retrieveLnRpym" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
        <![CDATA[
            SELECT /* SQL_ID: Qblo102x_01DAO.retrieveLnRpym */
                   LN_CNTR_NO    as lnCntrNo /* 융자계약번호 */
                   , LN_RPYM_SEQ    as lnRpymSeq /* 융자상환일련번호 */
                   , RPYM_FXDT_DT    as rpymFxdtDt /* 상환기일일자 */
                   , RPYM_DCD    as rpymDcd /* 상환구분코드 */
                   , RPYM_BLLN_AMT    as rpymBllnAmt /* 상환청구금액 */
                   , RPYM_DPSI_AMT    as rpymDpsiAmt /* 상환입금금액 */
                   , RPYM_UNCL_BLNC    as rpymUnclBlnc /* 상환미수잔액 */
                   , BFR_LN_RPYM_SEQ as bfrLnRpymSeq /*이전융자상환일련번호*/
                   , RMRK    as rmrk /* 비고 */
                   , LN_RPYM_VLDY_YN    as lnRpymVldyYn /* 융자상환유효여부 */
                   , DLY_OCRN_YN as dlyOcrnYn /* 연체발생여부 */
                   , DLY_CLCL_STRT_DT as dlyClclStrtDt /* 연체계산시작일자 */
                   , DLY_INTR_RT_CHNG_DT as dlyIntrRtChngDt /* 연체이자율변경일자 */
                   , RGPS_NO    as rgpsNo /* 등록자번호 */
                   , RGST_DTTM    as rgstDttm /* 등록일시 */
                   , UPRS_NO    as uprsNo /* 수정자번호 */
                   , ADJS_DTTM    as adjsDttm /* 수정일시 */
                   , LST_IP_ADDR    as lstIpAddr /* IP주소 */

	      FROM BLO102X A
	     WHERE A.LN_CNTR_NO = #lnCntrNo#
               AND A.LN_RPYM_SEQ = #lnRpymSeq#
        ]]>
    </select>

	<select id="retrieveLnRpymByLnCntr" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
        <![CDATA[
            SELECT /* SQL_ID: Qblo102x_01DAO.retrieveLnRpymByLnCntr */
                   LN_CNTR_NO    as lnCntrNo /* 융자계약번호 */
                   , LN_RPYM_SEQ    as lnRpymSeq /* 융자상환일련번호 */
                   , RPYM_FXDT_DT    as rpymFxdtDt /* 상환기일일자 */
                   , RPYM_DCD    as rpymDcd /* 상환구분코드 */
                   , RPYM_BLLN_AMT    as rpymBllnAmt /* 상환청구금액 */
                   , RPYM_DPSI_AMT    as rpymDpsiAmt /* 상환입금금액 */
                   , RPYM_UNCL_BLNC    as rpymUnclBlnc /* 상환미수잔액 */
                   , BFR_LN_RPYM_SEQ as bfrLnRpymSeq /*이전융자상환일련번호*/
                   , RMRK    as rmrk /* 비고 */
                   , LN_RPYM_VLDY_YN    as lnRpymVldyYn /* 융자상환유효여부 */
                   , DLY_OCRN_YN as dlyOcrnYn /* 연체발생여부 */
                   , DLY_CLCL_STRT_DT as dlyClclStrtDt /* 연체계산시작일자 */
                   , DLY_INTR_RT_CHNG_DT as dlyIntrRtChngDt /* 연체이자율변경일자 */
                   , RGPS_NO    as rgpsNo /* 등록자번호 */
                   , RGST_DTTM    as rgstDttm /* 등록일시 */
                   , UPRS_NO    as uprsNo /* 수정자번호 */
                   , ADJS_DTTM    as adjsDttm /* 수정일시 */
                   , LST_IP_ADDR    as lstIpAddr /* IP주소 */
	      FROM BLO102X A
	     WHERE A.LN_CNTR_NO = #lnCntrNo#
        ]]>
    </select>

    <select id="retrieveLnRpymAllList" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
        <![CDATA[
            SELECT /* SQL_ID: Qblo102x_01DAO.retrieveLnRpymAllList */
                   A.*
              FROM (
                    SELECT
                           LN_CNTR_NO    as lnCntrNo /* 융자계약번호 */
                           , LN_RPYM_SEQ    as lnRpymSeq /* 융자상환일련번호 */
                           , RPYM_FXDT_DT    as rpymFxdtDt /* 상환기일일자 */
                           , RPYM_DCD    as rpymDcd /* 상환구분코드 */
                           , RPYM_BLLN_AMT    as rpymBllnAmt /* 상환청구금액 */
                           , RPYM_DPSI_AMT    as rpymDpsiAmt /* 상환입금금액 */
                           , RPYM_UNCL_BLNC    as rpymUnclBlnc /* 상환미수잔액 */
                           , BFR_LN_RPYM_SEQ as bfrLnRpymSeq /*이전융자상환일련번호*/
                           , RMRK    as rmrk /* 비고 */
                           , LN_RPYM_VLDY_YN    as lnRpymVldyYn /* 융자상환유효여부 */
                           , DLY_OCRN_YN as dlyOcrnYn /* 연체발생여부 */
                           , DLY_CLCL_STRT_DT as dlyClclStrtDt /* 연체계산시작일자 */
                   		   , DLY_INTR_RT_CHNG_DT as dlyIntrRtChngDt /* 연체이자율변경일자 */
                           , RGPS_NO    as rgpsNo /* 등록자번호 */
                           , RGST_DTTM    as rgstDttm /* 등록일시 */
                           , UPRS_NO    as uprsNo /* 수정자번호 */
                           , ADJS_DTTM    as adjsDttm /* 수정일시 */
                           , LST_IP_ADDR    as lstIpAddr /* IP주소 */

	              FROM BLO102X A
	             WHERE 1=1
                       AND A.LN_CNTR_NO = #lnCntrNo#
                       AND A.LN_RPYM_SEQ = #lnRpymSeq#

                   ) A
             WHERE ROWNUM <= #rowCount# + 1
        ]]>
    </select>


    
     <select id="retrieveLnRpymSbjcList" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
		<![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRpymSbjcList  */
                   *
            FROM (
                    SELECT *
                    FROM (
                               SELECT
                                       A.LN_CNTR_NO              AS lnCntrNo     /* 융자번호       */
                                      ,substr(A.LN_CNTR_NO,0,16) AS shrtLnCntrNo /* 단축융자번호   */
                                      ,A.LN_RPYM_SEQ             AS lnRpymSeq    /* 상환일련번호   */
                                      ,D.EXTN_ORD                AS extnOrd      /* 차수 -연장차수 */
                                      ,D.UNMB_NO                 AS unmbNo       /* 조합원번호     */
                                      ,'['||D.UNMB_NO||'] '||C.ENNM_NM AS ennmNm /* 조합원명(상호) */
                                      ,D.LN_GDS_CD               AS lnGdsCd      /* 융자종류       */
                                      ,E.GDS_NM                  AS lnGdsNm      /* 융자종류명     */
                                      ,D.LN_DT                   AS lnDt         /* 융자일자       */
                                      ,D.AGR_NO                  AS agrNo        /* 약정번호       */
                                      ,A.RPYM_DCD                AS rpymDcd      /* 상환구분       */
                                      ,SF_SCO_CDNM('RPYM_DCD',A.RPYM_DCD) AS rpymDcdNm    /* 상환구분       */
                                      ,A.RPYM_FXDT_DT            AS rpymFxdtDt   /* 상환기한일자   */
                                      ,A.RMRK                    AS rmrk         /* 비고           */
                                      ,A.BFR_LN_RPYM_SEQ         AS bfrLnRpymSeq /*이전융자상환일련번호*/
                                      ,A.LN_RPYM_VLDY_YN         AS lnRpymVldyYn /* 융자상환유효여부*/
                                      ,NVL(A.RPYM_BLLN_AMT ,0)   AS rpymBllnAmt  /* 융자금액(상환청구금액)  */
                                      ,NVL(A.RPYM_UNCL_BLNC,0)   AS rpymUnclBlnc /* 융자잔액(상환미수잔액)  */
                                      ,NVL(A.RPYM_DPSI_AMT,0)    AS rpymDpsiAmt  /* 상환입금금액   */
                                      ,NVL(A.RPYM_BLLN_AMT ,0)   AS lnAmt        /* 융자금액(상환청구금액)  */
                                      ,NVL(A.RPYM_DPSI_AMT,0)    AS lnRpymAmt    /* 상환금액       */
                                      ,NVL(A.RPYM_UNCL_BLNC,0)   AS lnBlnc       /* 융자잔액(상환미수잔액)  */
                                      ,A.DLY_OCRN_YN 			 AS dlyOcrnYn 		/* 연체발생여부 */
                           			  ,A.DLY_CLCL_STRT_DT 		 AS dlyClclStrtDt 	/* 연체계산시작일자 */
                   		   			  ,A.DLY_INTR_RT_CHNG_DT 	 AS dlyIntrRtChngDt /* 연체이자율변경일자 */
                                      ,D.JB_BRNC_CD              AS jbBrncCd     /* 관할지점코드   */
                                      ,D.BFR_LN_CNTR_NO          AS bfrLnCntrNo  /* 이전융자계약번호         */
                                      ,F.PRNT_OFFN               AS jbBrncNm     /* 관할지점명     */
                                      ,SYS_CONTEXT('USERENV','IP_ADDRESS') AS ipAddr /* IP주소      */
                                      ,COUNT(*) OVER()           AS blobInqrCnt  /* 총건수         */
                              FROM     BLO102X A /* 융자상환내역 */
                                      ,BUM200M B /* 조합원기본   */
                                      ,BUM100M C /* 고객기본     */
                                      ,BLO100M D /* 융자계약기본 */
                                      ,BCO001M E /* BCO_상품기본 */
                                      ,VI_TM_BRCHXM F /* 관할지점VIEW */
                              WHERE    A.LN_CNTR_NO = D.LN_CNTR_NO
                              AND      B.CSTM_NO    = C.CSTM_NO
                              AND      D.UNMB_NO    = B.UNMB_NO
                              AND      A.LN_RPYM_VLDY_YN = 'Y'
                              AND      D.LN_SCD     IN ('0003','0004','0010') /* 융자상태 - 정상, 이관, 상환완료 */
                              AND      D.VLDY_YN    = 'Y' /* 유효여부 */
                              AND      D.LN_GDS_CD  = E.GDS_CD
                              AND      E.GDS_CLSF_CD = '0003' /*상품분류 -융자*/
                              AND      D.JB_BRNC_CD = F.ENFC_CODE
                              AND      (#lnCntrNo# IS NULL OR A.LN_CNTR_NO like substr(#lnCntrNo#,0,16)||'%') /* 융자번호     */
                              AND      D.LN_GDS_CD  LIKE DECODE(#lnGdsCd#, NULL, '%', #lnGdsCd#)   /* 융자종류     */
                              AND      D.UNMB_NO    LIKE DECODE(#unmbNo#, NULL, '%', #unmbNo#)       /* 조합원번호   */
                              AND      (#clclStrtDt# IS NULL OR D.LN_DT >= #clclStrtDt#)
                              AND      (#clclEndDt#  IS NULL OR D.LN_DT <= #clclEndDt#)
                              AND      D.JB_BRNC_CD LIKE DECODE(#jbBrncCd#, NULL, '%', #jbBrncCd#) /* 업무지점코드 */
                          )
                  WHERE unmbNo >= NVL(#nextKey1#,' ')
                  AND   (
                  		 	 unmbNo > #nextKey1#
                  		OR  (unmbNo = #nextKey1# AND lnCntrNo > #nextKey2# )
                  		OR  (unmbNo = #nextKey1# AND lnCntrNo = #nextKey2# AND lnRpymSeq >= #nextKey3#)
                        )
                  ORDER BY unmbNo      /* 조합원번호       */
                          ,lnCntrNo    /* 융자번호         */
                          ,lnRpymSeq   /* 융자상환일련번호 */
                  )
        	WHERE ROWNUM <= #rowCount# + 1
		]]>
    </select>

    
     <select id="retrieveLnRpymSbjcAllList" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
		<![CDATA[
			   SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRpymSbjcAllList  */  *
               FROM (
                          SELECT
                                  A.LN_CNTR_NO              AS lnCntrNo     /* 융자번호       */
                                 ,substr(A.LN_CNTR_NO,0,16) AS shrtLnCntrNo /* 단축융자번호   */
                                 ,A.LN_RPYM_SEQ             AS lnRpymSeq    /* 상환일련번호   */
                                 ,D.EXTN_ORD                AS extnOrd      /* 차수 -연장차수 */
                                 ,D.UNMB_NO                 AS unmbNo       /* 조합원번호     */
                                 ,'['||D.UNMB_NO||'] '||C.ENNM_NM AS ennmNm /* 조합원명(상호) */
                                 ,D.LN_GDS_CD               AS lnGdsCd      /* 융자종류       */
                                 ,E.GDS_NM                  AS lnGdsNm      /* 융자종류명     */
                                 ,D.LN_DT                   AS lnDt         /* 융자일자       */
                                 ,D.AGR_NO                  AS agrNo        /* 약정번호       */
                                 ,A.RPYM_DCD                AS rpymDcd      /* 상환구분       */
                                 ,SF_SCO_CDNM('RPYM_DCD',A.RPYM_DCD) AS rpymDcdNm    /* 상환구분       */
                                 ,A.RPYM_FXDT_DT            AS rpymFxdtDt   /* 상환기한일자   */
                                 ,A.RMRK                    AS rmrk         /* 비고           */
                                 ,A.BFR_LN_RPYM_SEQ         AS bfrLnRpymSeq /*이전융자상환일련번호*/
                                 ,A.LN_RPYM_VLDY_YN         AS lnRpymVldyYn /* 융자상환유효여부*/
                                 ,NVL(A.RPYM_BLLN_AMT ,0)   AS rpymBllnAmt  /* 융자금액(상환청구금액)  */
                                 ,NVL(A.RPYM_UNCL_BLNC,0)   AS rpymUnclBlnc /* 융자잔액(상환미수잔액)  */
                                 ,NVL(A.RPYM_DPSI_AMT,0)    AS rpymDpsiAmt  /* 상환입금금액   */
                                 ,NVL(A.RPYM_BLLN_AMT ,0)   AS lnAmt        /* 융자금액(상환청구금액)  */
                                 ,NVL(A.RPYM_DPSI_AMT,0)    AS lnRpymAmt    /* 상환금액       */
                                 ,NVL(A.RPYM_UNCL_BLNC,0)   AS lnBlnc       /* 융자잔액(상환미수잔액)  */
                                 ,A.DLY_OCRN_YN 			AS dlyOcrnYn 	   /* 연체발생여부 */
                           		 ,A.DLY_CLCL_STRT_DT 		AS dlyClclStrtDt   /* 연체계산시작일자 */
                   		   		 ,A.DLY_INTR_RT_CHNG_DT 	AS dlyIntrRtChngDt /* 연체이자율변경일자 */
                                 ,D.JB_BRNC_CD              AS jbBrncCd     /* 관할지점코드   */
                                 ,D.BFR_LN_CNTR_NO          AS bfrLnCntrNo  /* 이전융자계약번호         */
                                 ,F.PRNT_OFFN               AS jbBrncNm     /* 관할지점명     */
                                 ,SYS_CONTEXT('USERENV','IP_ADDRESS') AS ipAddr /* IP주소      */
                                 ,COUNT(*) OVER()           AS blobInqrCnt  /* 총건수         */
                         FROM     BLO102X A /* 융자상환내역 */
                                 ,BUM200M B /* 조합원기본   */
                                 ,BUM100M C /* 고객기본     */
                                 ,BLO100M D /* 융자계약기본 */
                                 ,BCO001M E /* BCO_상품기본 */
                                 ,VI_TM_BRCHXM F /* 관할지점VIEW */
                         WHERE    A.LN_CNTR_NO = D.LN_CNTR_NO
                         AND      B.CSTM_NO    = C.CSTM_NO
                         AND      D.UNMB_NO    = B.UNMB_NO
                         AND      A.LN_RPYM_VLDY_YN = 'Y'
                         AND      D.LN_SCD     IN ('0003','0004','0010') /* 융자상태 - 정상, 이관, 상환완료 */
                         AND      D.VLDY_YN    = 'Y' /* 유효여부 */
                         AND      D.LN_GDS_CD  = E.GDS_CD
                         AND      E.GDS_CLSF_CD = '0003' /*상품분류 -융자*/
                         AND      D.JB_BRNC_CD = F.ENFC_CODE
                         AND      (#lnCntrNo# IS NULL OR A.LN_CNTR_NO like substr(#lnCntrNo#,0,16)||'%') /* 융자번호     */
                         AND      D.LN_GDS_CD  LIKE DECODE(#lnGdsCd#, NULL, '%', #lnGdsCd#)   /* 융자종류     */
                         AND      D.UNMB_NO    LIKE DECODE(#unmbNo#, NULL, '%', #unmbNo#)       /* 조합원번호   */
                         AND      (#clclStrtDt# IS NULL OR D.LN_DT >= #clclStrtDt#)
                         AND      (#clclEndDt#  IS NULL OR D.LN_DT <= #clclEndDt#)
                         AND      D.JB_BRNC_CD LIKE DECODE(#jbBrncCd#, NULL, '%', #jbBrncCd#) /* 업무지점코드 */
                     )
             ORDER BY unmbNo      /* 조합원번호       */
                     ,lnCntrNo    /* 융자번호         */
                     ,lnRpymSeq   /* 융자상환일련번호 */
		]]>
    </select>


   
     <select id="retrieveLnRpymSbjcListDtl" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
		<![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRpymSbjcListDtl  */
                   *
            FROM (
                    SELECT *
                    FROM (
                               SELECT
                                       A.LN_CNTR_NO              AS lnCntrNo     /* 융자번호       */
                                      ,substr(A.LN_CNTR_NO,0,16) AS shrtLnCntrNo /* 단축융자번호   */
                                      ,A.LN_RPYM_SEQ             AS lnRpymSeq    /* 상환일련번호   */
                                      ,D.EXTN_ORD                AS extnOrd      /* 차수 -연장차수 */
                                      ,D.UNMB_NO                 AS unmbNo       /* 조합원번호     */
                                      ,'['||D.UNMB_NO||'] '||C.ENNM_NM AS ennmNm /* 조합원명(상호) */
                                      ,D.LN_GDS_CD               AS lnGdsCd      /* 융자종류       */
                                      ,E.GDS_NM                  AS lnGdsNm      /* 융자종류명     */
                                      ,D.LN_DT                   AS lnDt         /* 융자일자       */
                                      ,D.AGR_NO                  AS agrNo        /* 약정번호       */
                                      ,A.RPYM_DCD                AS rpymDcd      /* 상환구분       */
                                      ,SF_SCO_CDNM('RPYM_DCD',A.RPYM_DCD) AS rpymDcdNm    /* 상환구분       */
                                      ,A.RPYM_FXDT_DT            AS rpymFxdtDt   /* 상환기한일자   */
                                      ,A.RMRK                    AS rmrk         /* 비고           */
                                      ,A.BFR_LN_RPYM_SEQ         AS bfrLnRpymSeq /*이전융자상환일련번호*/
                                      ,A.LN_RPYM_VLDY_YN         AS lnRpymVldyYn /* 융자상환유효여부*/
                                      ,NVL(A.RPYM_BLLN_AMT ,0)   AS rpymBllnAmt  /* 융자금액(상환청구금액)  */
                                      ,NVL(A.RPYM_UNCL_BLNC,0)   AS rpymUnclBlnc /* 융자잔액(상환미수잔액)  */
                                      ,NVL(A.RPYM_DPSI_AMT,0)    AS rpymDpsiAmt  /* 상환입금금액   */
                                      ,NVL(A.RPYM_BLLN_AMT ,0)   AS lnAmt        /* 융자금액(상환청구금액)  */
                                      ,NVL(A.RPYM_DPSI_AMT,0)    AS lnRpymAmt    /* 상환금액       */
                                      ,NVL(A.RPYM_UNCL_BLNC,0)   AS lnBlnc       /* 융자잔액(상환미수잔액)  */
                                      ,A.DLY_OCRN_YN 			 AS dlyOcrnYn 	    /* 연체발생여부 */
                           		 	  ,A.DLY_CLCL_STRT_DT 		 AS dlyClclStrtDt   /* 연체계산시작일자 */
                   		   		 	  ,A.DLY_INTR_RT_CHNG_DT 	 AS dlyIntrRtChngDt /* 연체이자율변경일자 */
                                      ,D.JB_BRNC_CD              AS jbBrncCd     /* 관할지점코드   */
                                      ,D.BFR_LN_CNTR_NO          AS bfrLnCntrNo  /* 이전융자계약번호         */
                                      ,F.PRNT_OFFN               AS jbBrncNm     /* 관할지점명     */
                                      ,SYS_CONTEXT('USERENV','IP_ADDRESS') AS ipAddr /* IP주소      */
                                      ,COUNT(*) OVER()           AS blobInqrCnt  /* 총건수         */
                                      ,G.LN_UNCL_NO              AS lnUnclNo     	/* 융자미수번호 */
					                  ,G.CLCT_UNT_NO             AS clctUntNo    	/* 정산단위기본번호 */
					                  ,G.CLCT_DT					AS clctDt
                              FROM     BLO102X A /* 융자상환내역 */
                                      ,BUM200M B /* 조합원기본   */
                                      ,BUM100M C /* 고객기본     */
                                      ,BLO100M D /* 융자계약기본 */
                                      ,BCO001M E /* BCO_상품기본 */
                                      ,VI_TM_BRCHXM F /* 관할지점VIEW */
                                      ,BRP106X G /* 융자미수내역 */
                              WHERE    A.LN_CNTR_NO = D.LN_CNTR_NO
                              AND      B.CSTM_NO    = C.CSTM_NO
                              AND      D.UNMB_NO    = B.UNMB_NO
                              AND      A.LN_CNTR_NO = G.LN_CNTR_NO(+)
         					  AND      A.LN_RPYM_SEQ = G.LN_RPYM_SEQ(+)
                              AND      A.LN_RPYM_VLDY_YN = 'Y'
                              AND      G.VLDY_YN(+)	= 'Y'
                              AND      D.LN_SCD     IN ('0003','0004','0010') /* 융자상태 - 정상, 이관, 상환완료 */
                              AND      D.VLDY_YN    = 'Y' /* 유효여부 */
                              AND      D.LN_GDS_CD  = E.GDS_CD
                              AND      E.GDS_CLSF_CD = '0003' /*상품분류 -융자*/
                              AND      D.JB_BRNC_CD = F.ENFC_CODE
                              AND      (#lnCntrNo# IS NULL OR A.LN_CNTR_NO = #lnCntrNo#) /* 융자번호     */
                              AND      D.LN_GDS_CD  LIKE DECODE(#lnGdsCd#, NULL, '%', #lnGdsCd#)   /* 융자종류     */
                              AND      D.UNMB_NO    LIKE DECODE(#unmbNo#, NULL, '%', #unmbNo#)       /* 조합원번호   */
                              AND      (#clclStrtDt# IS NULL OR D.LN_DT >= #clclStrtDt#)
                              AND      (#clclEndDt#  IS NULL OR D.LN_DT <= #clclEndDt#)
                              AND      D.JB_BRNC_CD LIKE DECODE(#jbBrncCd#, NULL, '%', #jbBrncCd#) /* 업무지점코드 */
                          )
                  WHERE unmbNo >= NVL(#nextKey1#,' ')
                  AND   (
                  		 	 unmbNo > #nextKey1#
                  		OR  (unmbNo = #nextKey1# AND lnCntrNo > #nextKey2# )
                  		OR  (unmbNo = #nextKey1# AND lnCntrNo = #nextKey2# AND lnRpymSeq >= #nextKey3#)
                        )
                  ORDER BY unmbNo      /* 조합원번호       */
                          ,lnCntrNo    /* 융자번호         */
                          ,lnRpymSeq   /* 융자상환일련번호 */
                  )
        	WHERE ROWNUM <= #rowCount# + 1
		]]>
    </select>

	
	<select id="retrieveMaxLnRpymSeq" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
	   <![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveMaxLnRpymSeq */
			      MAX(LN_RPYM_SEQ) AS lnRpymSeq
			FROM   BLO102X
			WHERE  LN_CNTR_NO = #lnCntrNo#
		]]>
	</select>


	
	<select id="retrieveRcvLnRpymDscr" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
	<![CDATA[
	SELECT /* SQL_ID: Qblo102x_01DAO.retrieveRcvLnRpymDscr */ *
        FROM (
            SELECT DISTINCT *
            FROM (
                SELECT /*+ LEADING(A) USE_NL(A B C D) */
                     D.LN_CNTR_NO    		as lnCntrNo 		/* 융자계약번호 */
                   , B.CLCT_UNT_NO    		as clctUntNo 		/* 정산단위번호 */
                   , D.LN_RPYM_SEQ    		as lnRpymSeq 		/* 융자상환일련번호 */
                   , D.RPYM_FXDT_DT    		as rpymFxdtDt 		/* 상환기일일자 */
                   , B.CLCT_DT         		as clctDt 			/* 정산일자 */
                   , D.RPYM_DCD    			as rpymDcd 			/* 상환구분코드 */
                   , SF_SCO_CDNM('RPYM_DCD',A.RPYM_DCD) AS rpymDcdNm    /* 상환구분       */
                   , D.RPYM_BLLN_AMT    	as rpymBllnAmt 		/* 상환청구금액 */
                   , D.RPYM_DPSI_AMT    	as rpymDpsiAmt 		/* 상환입금금액 */
                   , D.RPYM_UNCL_BLNC    	as rpymUnclBlnc 	/* 상환미수잔액 */
                   , D.BFR_LN_RPYM_SEQ 		as bfrLnRpymSeq 	/*이전융자상환일련번호*/
                   , D.RMRK    				as rmrk 			/* 비고 */
                   , D.LN_RPYM_VLDY_YN  	as lnRpymVldyYn 	/* 융자상환유효여부 */
                   , D.DLY_OCRN_YN 			as dlyOcrnYn 	   	/* 연체발생여부 */
                   , D.DLY_CLCL_STRT_DT 	as dlyClclStrtDt   	/* 연체계산시작일자 */
                   , D.DLY_INTR_RT_CHNG_DT 	as dlyIntrRtChngDt 	/* 연체이자율변경일자 */
                   , D.RGPS_NO    			as rgpsNo 			/* 등록자번호 */
                   , D.RGST_DTTM    		as rgstDttm 		/* 등록일시 */
                   , D.UPRS_NO    			as uprsNo 			/* 수정자번호 */
                   , D.ADJS_DTTM    		as adjsDttm 		/* 수정일시 */
                   , D.LST_IP_ADDR    		as lstIpAddr 		/* IP주소 */
                FROM BLO102X A /* BLO_융자상환내역 */
                    ,BRP106X B /* BRP_융자미수내역 */
                    ,BRP106X C /* BRP_융자미수내역 */
                    ,BLO102X D /* BLO_융자상환내역 */
                    ,BRP110X E /* BRP_정산내역     */
                    ,BRP120M F /* BRP_정산단위기본 */
                WHERE A.LN_CNTR_NO  = #lnCntrNo#
                AND   A.LN_RPYM_SEQ = #lnRpymSeq#
                AND   A.LN_RPYM_VLDY_YN = 'Y'
                AND   A.LN_CNTR_NO  = B.LN_CNTR_NO
                AND   A.LN_RPYM_SEQ = B.LN_RPYM_SEQ
                AND   B.VLDY_YN		= 'Y'
                AND   B.CLCT_UNT_NO = C.CLCT_UNT_NO   /* 정산단위번호*/
                AND   C.LN_CNTR_NO  = D.LN_CNTR_NO
                AND   C.LN_RPYM_SEQ = D.LN_RPYM_SEQ
                AND   D.LN_RPYM_VLDY_YN = 'Y'
                AND   C.CLCT_UNT_NO = E.CLCT_UNT_NO
		        AND   E.CLCT_UNT_NO = F.CLCT_UNT_NO
	            AND   D.LN_CNTR_NO >= NVL(#nextKey1#,' ')
	            AND   (
	                        D.LN_CNTR_NO > #nextKey1#
	                    OR (D.LN_CNTR_NO = #nextKey1# AND D.LN_RPYM_SEQ >= #nextKey2#)
	                  )
                ORDER BY D.LN_CNTR_NO, D.LN_RPYM_SEQ
            )
            )
        WHERE ROWNUM <= #rowCount# + 1

	]]>
	</select>

	
	<select id="retrieveLnRpymList" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
		<![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRpymList  */
					*
			FROM (
		        	SELECT A.lnCntrNo
	                      ,A.lnRpymSeq
	                      ,A.rpymFxdtDt
	                      ,A.lnPcd
	                      ,DECODE(A.extnOrd,0,'신규',DECODE(B.lnUnclNo, NULL, '연장상환', A.lnPcdNm)) AS lnPcdNm
	                      ,A.rpymBllnAmt
	                      ,A.rpymDpsiAmt
	                      ,A.rpymUnclBlnc
	                      ,A.rmrk
	                      ,A.rpymDcd
	                      ,A.rpymDcdNm
	                      ,B.lnUnclNo
	                      ,B.clctUntNo
	                      ,B.clctDt
			        FROM (
			                SELECT B.LN_CNTR_NO                       AS lnCntrNo     /* 융자계약번호   */
			                      ,B.LN_RPYM_SEQ                      AS lnRpymSeq    /* 상환일련번호   */
	                              ,B.RPYM_FXDT_DT                     AS rpymFxdtDt   /* 상환기한일자   */
			                      ,A.LN_PCD                           AS lnPcd        /* 융자처리코드   */
			                      ,SF_SCO_CDNM('LN_PCD',A.LN_PCD)     AS lnPcdNm      /* 융자처리코드명 */
			                      ,B.RPYM_DCD                         AS rpymDcd      /* 상환구분코드   */
			                      ,SF_SCO_CDNM('RPYM_DCD',B.RPYM_DCD) AS rpymDcdNm    /* 상환구분코드명 */
			                      ,B.RPYM_BLLN_AMT                    AS rpymBllnAmt  /* 상환청구금액   */
			                      ,B.RPYM_DPSI_AMT                    AS rpymDpsiAmt  /* 상환입금금액   */
			                      ,B.RPYM_UNCL_BLNC                   AS rpymUnclBlnc /* 상환미수잔액   */
			                      ,B.RMRK                             AS rmrk         /* 비고           */
			                      ,A.EXTN_ORD                         AS extnOrd      /* 연장차수       */
			                FROM   BLO100M A /* BLO_융자계약기본 */
			                      ,BLO102X B /* BLO_융자상환내역 */
			                WHERE  A.LN_CNTR_NO      = #lnCntrNo#
			                AND    A.LN_CNTR_NO = B.LN_CNTR_NO
			                AND    B.LN_RPYM_VLDY_YN = 'Y'
			        ) A
	                 ,(
		                    SELECT C.LN_CNTR_NO    AS lnCntrNo
		                          ,NVL(C.LN_RPYM_SEQ,1)   AS lnRpymSeq
		                          ,C.LN_UNCL_NO    AS lnUnclNo
		                          ,C.CLCT_UNT_NO   AS clctUntNo
		                          ,C.CLCT_DT       AS clctDt
		                    FROM   BRP106X C /* BRP_융자미수내역 */
		                          ,BRP100M D /* BRP_청구기본     */
		                    WHERE  C.LN_CNTR_NO  = #lnCntrNo#
		                    AND    C.LN_UNCL_NO  = D.LN_UNCL_NO
		                    AND    C.LN_RPYM_SEQ IS NOT NULL
		                    AND    C.VLDY_YN='Y'
	                  ) B
			    WHERE     A.lnCntrNo  = B.lnCntrNo(+)
	            AND       A.lnRpymSeq = B.lnRpymSeq(+)
	            ORDER BY  A.lnCntrNo
	                    , A.lnRpymSeq
			)
		]]>
	</select>


	
    <select id="retrieveLnRpymUnmbNoList" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
		<![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRpymUnmbNoList  */
					*
			FROM (
                    SELECT A.* /*, SF_GET_LO_SUBSUM(&lnCntrNo&, rownum)  rpymUnclBlnc */
                    , SUM(rpymBllnAmt-rpymDpsiAmt) OVER(ORDER BY rownum) rpymUnclBlnc
                     FROM (
                           SELECT *
                             FROM (

                           SELECT B.LN_CNTR_NO  AS lnCntrNo     /* 융자계약번호   */
                                  , unmb_no AS unmbNo
                                  ,NVL(CASE WHEN A.LN_PCD IN ('0005','0006')
                                  			THEN NVL(CLCT_DT, CASE WHEN DLY_CLCL_STRT_DT > TO_CHAR(B.RGST_DTTM, 'YYYYMMDD')  THEN TO_CHAR(B.RGST_DTTM, 'YYYYMMDD') ELSE  DLY_CLCL_STRT_DT END )
                                        ELSE A.LN_DT
                                   END, B.RPYM_FXDT_DT) rpymFxdtDt
			                      ,A.LN_PCD                           AS lnPcd        /* 융자처리코드   */
			                      ,NVL((SELECT NVL(EXTN_ORD, 0) FROM BLO100M WHERE LN_CNTR_NO = TO_CHAR(TO_NUMBER(B.LN_CNTR_NO)+1)),0) EXT
                                  ,A.LN_INRT||'%'                          AS lnInrt        /* 융자이자   */
			                      ,DECODE (A.LN_PCD, '0001',SF_SCO_CDNM('LN_PCD',A.LN_PCD) ,
                                   SF_SCO_CDNM('LN_PCD',A.LN_PCD) || DECODE(A.RMRK, null, '',  /*'[' || A.RMRK || ']'*/'')
                                  || ' [' || (SELECT SUBSTR(LN_DT, 1,4) ||'-'|| SUBSTR(LN_DT, 5,2) ||'-'||SUBSTR(LN_DT, 7,2) ||', '
                                        || TRIM(TO_CHAR( LN_AMT , '999,999,999,999,999')) || '원' DT  FROM BLO100M
                                        WHERE LN_CNTR_NO IN (SELECT ORGL_LN_CNTR_NO FROM BLO100M WHERE LN_CNTR_NO=B.LN_CNTR_NO ) ) ||']'
                                  ) AS lnPcdNm      /* 융자처리코드명 */
			                      ,B.RPYM_DCD                                            AS rpymDcd      /* 상환구분코드   */
			                      ,DECODE(A.LN_PCD, '0003', DECODE(A.EXTN_ORD, 0, '', A.EXTN_ORD), '')                 AS extnOrd      /* 연장차수       */
                                  ,NVL(A.INTR_PD_DAY, SUBSTR(A.RPYM_FXDT_DT,7,2))        AS intrPdDay    /* 이자납입일 */
			                      ,DECODE(A.LN_PCD , '0001',   B.RPYM_BLLN_AMT,'0011', B.RPYM_BLLN_AMT, '0012', B.RPYM_BLLN_AMT, '0013', B.RPYM_BLLN_AMT, '0003', 0,  0)  AS rpymBllnAmt  /* 상환청구금액   */
			                      ,DECODE(A.LN_PCD , '0004', LN_AMT, B.RPYM_DPSI_AMT)
			                      /*,B.RPYM_DPSI_AMT*/                    AS rpymDpsiAmt  /* 상환입금금액   */

			                FROM   /*BLO100M A*/ /* BLO_융자계약기본 */
				                   (SELECT * FROM BLO100M
				                	 WHERE LN_SCD IN ('0003','0004','0010','0011') AND LN_GV_SCD = '0004'
				                       AND NOT LN_CNTR_NO IN ('20020700511050010004' ,'20020700511050010006' ,'20020100511050020007' ,'20020700511050010007')
	                                   AND NOT LN_CNTR_NO IN ('20020100511050010004')
				                   )A /* BLO_융자계약기본 */
			                      ,BLO102X B /* BLO_융자상환내역 */

		                          ,(SELECT C.LN_CNTR_NO
				                          ,NVL(C.LN_RPYM_SEQ,1) LN_RPYM_SEQ
				                          ,C.LN_UNCL_NO
				                          ,C.CLCT_UNT_NO
				                          ,C.CLCT_DT
				                    FROM   BRP106X C /* BRP_융자미수내역 */
				                          ,BRP100M D /* BRP_청구기본     */
				                    WHERE  C.LN_UNCL_NO  = D.LN_UNCL_NO
				                    AND    C.LN_RPYM_SEQ IS NOT NULL
				                    AND    C.VLDY_YN = 'Y') D
			                WHERE  A.UNMB_NO IN (SELECT UNMB_NO FROM BLO100M WHERE LN_CNTR_NO = #lnCntrNo# /**P*/ )
			                AND    A.LN_CNTR_NO = B.LN_CNTR_NO(+)
			                AND    B.LN_RPYM_VLDY_YN(+) = 'Y'
                            AND    B.LN_CNTR_NO = D.LN_CNTR_NO(+)
                            AND    B.LN_RPYM_SEQ = D.LN_RPYM_SEQ(+)
                            AND    A.LN_CNTR_NO  NOT IN
                                   (CASE WHEN (SELECT RMRK FROM BLO100M WHERE LN_CNTR_NO =  #lnCntrNo#   ) =
                                              (SELECT REPLACE(RMRK,'기한이익', '') FROM BLO100M WHERE LN_CNTR_NO =  #lnCntrNo#   )
                                         THEN (
                                               CASE WHEN '일부상환처리' = (SELECT REPLACE(RMRK,' ','')
                                                                            FROM BLO100M
                                                                           WHERE LN_CNTR_NO = (SELECT BFR_LN_CNTR_NO FROM BLO100M WHERE LN_CNTR_NO =   #lnCntrNo#))
                                                    THEN ' '
                                                    ELSE (SELECT BFR_LN_CNTR_NO FROM BLO100M WHERE LN_CNTR_NO = #lnCntrNo#)
                                               END
                                              )
                                         /* 기한이익상실처리 시 내역 안보이는 문제로 인해 추가함(2020.05.13) */
                                         ELSE ' '
                                    END)

                            ORDER BY rpymFxdtDt, lnCntrNo
                            ) WHERE NOT (lnPcd='0006' AND  EXT<>0)
                       ) A
			)
		]]>
	</select>


	
    <select id="retrieveLnRpymUnmbNoListNow" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
		<![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRpymUnmbNoListNow  */
					*
			FROM (

			SELECT
			     C.GDS_NM       AS lnGdsNm    /* 융자상품명   */
		        ,A.RPYM_FXDT_DT AS rpymFxdtDt    /* 상환기한일자 */
		        ,A.LN_AMT       AS lnAmt         /* 융자금액     */
		        ,A.LN_DT        AS lnDt          /* 융자일자     */
		        ,A.LN_BLNC      AS lnBlnc        /* 융자잔액     */
		        ,A.LN_INRT      AS lnInrt        /* 융자이율     */
		        ,A.LN_CNTR_NO   AS lnCntrNo
		        ,DECODE (EXTN_ORD, 0, '신규', TO_CHAR(EXTN_ORD) ||'차 연장' ) rmrk
		    FROM
		        BLO100M A,
		        BLO101X B,
		        BCO001M C,
		        (
		            SELECT
		                SUBSTR(B.LN_CNTR_NO,0,16)||MAX(SUBSTR(B.LN_CNTR_NO,17,4)) as MAX_CONTRNCT_NO
		            FROM
		                BLO100M A,
		                BLO101X B,
		                BLO102X C
		            WHERE A.LN_CNTR_NO = B.LN_CNTR_NO
		              AND A.LN_CNTR_NO = C.LN_CNTR_NO
		              AND A.LN_SCD IN ('0003','0004','0010')
		              AND B.LN_EXCN_DT <=  TO_CHAR(SYSDATE, 'YYYYMMDD')
		              AND A.UNMB_NO IN (SELECT UNMB_NO FROM BLO100M WHERE LN_CNTR_NO = #lnCntrNo# /**P*/ )
		            GROUP BY SUBSTR(B.LN_CNTR_NO,0,16)
		        )  D
		    WHERE
		        A.LN_SCD IN ('0003','0004') /* 정상, 이관*/
		        AND A.LN_CNTR_NO = B.LN_CNTR_NO
		        AND A.LN_GDS_CD = C.GDS_CD
		        AND B.LN_EXCN_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD')
		        AND A.UNMB_NO IN (SELECT UNMB_NO FROM BLO100M WHERE LN_CNTR_NO = #lnCntrNo# /**P*/ )
		        AND A.LN_DT  <=  TO_CHAR(SYSDATE, 'YYYYMMDD')
		        AND A.LN_CNTR_NO = D.MAX_CONTRNCT_NO
		        AND A.LN_BLNC > 0
		    ORDER BY
		        A.LN_CNTR_NO,
		        A.LN_DT,
		        A.RPYM_FXDT_DT
			)
		]]>
	</select>

	
    <select id="retrieveLnDlyOcrnYn102x" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
       <![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnDlyOcrnYn102x  */
				   DLY_OCRN_YN AS dlyOcrnYn	/* 연체발생여부 */
				 , LN_RPYM_SEQ AS lnRpymSeq     /* 융자상환일련번호 */
			  FROM BLO102X
			 WHERE LN_CNTR_NO = #lnCntrNo#
			   AND LN_RPYM_VLDY_YN = 'Y'
	   ]]>
    </select>

	
    <select id="retrieveLnRschBrwRpym" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
       <![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRschBrwRpym  */
				   LN_CNTR_NO	as lnCntrNo
			     , LN_RPYM_SEQ	as lnRpymSeq
			     , RPYM_FXDT_DT	as rpymFxdtDt
			     , RPYM_DCD		as rpymDcd
			  FROM BLO102X
			 WHERE LN_CNTR_NO = #lnCntrNo#
			   AND LN_RPYM_VLDY_YN = 'Y'
	   ]]>
    </select>

	<select id="retrieveLnRpymListForDtl" resultClass="Qblo102x_01DAO.LnRpymDscrRsltVo">
		<![CDATA[
			SELECT /* SQL_ID : Qblo102x_01DAO.retrieveLnRpymListForDtl  */
                  A.LN_CNTR_NO              AS lnCntrNo     /* 융자번호       */
                 ,substr(A.LN_CNTR_NO,0,16) AS shrtLnCntrNo /* 단축융자번호   */
                 ,A.LN_RPYM_SEQ             AS lnRpymSeq    /* 상환일련번호   */
                 ,D.EXTN_ORD                AS extnOrd      /* 차수 -연장차수 */
                 ,D.UNMB_NO                 AS unmbNo       /* 조합원번호     */
                 ,'['||D.UNMB_NO||'] '||C.ENNM_NM AS ennmNm /* 조합원명(상호) */
                 ,D.LN_GDS_CD               AS lnGdsCd      /* 융자종류       */
                 ,E.GDS_NM                  AS lnGdsNm      /* 융자종류명     */
                 ,D.LN_DT                   AS lnDt         /* 융자일자       */
                 ,D.AGR_NO                  AS agrNo        /* 약정번호       */
                 ,A.RPYM_DCD                AS rpymDcd      /* 상환구분       */
                 ,SF_SCO_CDNM('RPYM_DCD',A.RPYM_DCD) AS rpymDcdNm    /* 상환구분       */
                 ,A.RPYM_FXDT_DT            AS rpymFxdtDt   /* 상환기한일자   */
                 ,A.RMRK                    AS rmrk         /* 비고           */
                 ,A.BFR_LN_RPYM_SEQ         AS bfrLnRpymSeq /*이전융자상환일련번호*/
                 ,A.LN_RPYM_VLDY_YN         AS lnRpymVldyYn /* 융자상환유효여부*/
                 ,NVL(A.RPYM_BLLN_AMT ,0)   AS rpymBllnAmt  /* 융자금액(상환청구금액)  */
                 ,NVL(A.RPYM_UNCL_BLNC,0)   AS rpymUnclBlnc /* 융자잔액(상환미수잔액)  */
                 ,NVL(A.RPYM_DPSI_AMT,0)    AS rpymDpsiAmt  /* 상환입금금액   */
                 ,NVL(A.RPYM_BLLN_AMT ,0)   AS lnAmt        /* 융자금액(상환청구금액)  */
                 ,NVL(A.RPYM_DPSI_AMT,0)    AS lnRpymAmt    /* 상환금액       */
                 ,NVL(A.RPYM_UNCL_BLNC,0)   AS lnBlnc       /* 융자잔액(상환미수잔액)  */
                 ,A.DLY_OCRN_YN 			AS dlyOcrnYn 	   /* 연체발생여부 */
                 ,A.DLY_CLCL_STRT_DT 		AS dlyClclStrtDt   /* 연체계산시작일자 */
                 ,A.DLY_INTR_RT_CHNG_DT 	AS dlyIntrRtChngDt /* 연체이자율변경일자 */
                 ,D.JB_BRNC_CD              AS jbBrncCd     	/* 관할지점코드   */
                 ,D.BFR_LN_CNTR_NO          AS bfrLnCntrNo  	/* 이전융자계약번호         */
                 ,F.PRNT_OFFN               AS jbBrncNm     	/* 관할지점명     */
                 ,SYS_CONTEXT('USERENV','IP_ADDRESS') AS ipAddr /* IP주소      */
                 ,COUNT(*) OVER()           AS blobInqrCnt  	/* 총건수         */
                 ,G.LN_UNCL_NO              AS lnUnclNo     	/* 융자미수번호 */
                 ,G.CLCT_UNT_NO             AS clctUntNo    	/* 정산단위기본번호 */
                 ,G.CLCT_DT					AS clctDt
                 ,D.INTR_PD_DAY             AS intrPdDay
         FROM     BLO102X A /* 융자상환내역 */
                 ,BUM200M B /* 조합원기본   */
                 ,BUM100M C /* 고객기본     */
                 ,BLO100M D /* 융자계약기본 */
                 ,BCO001M E /* BCO_상품기본 */
                 ,VI_TM_BRCHXM F /* 관할지점VIEW */
                 ,BRP106X G /* 융자미수내역 */
         WHERE    A.LN_CNTR_NO = D.LN_CNTR_NO
         AND      B.CSTM_NO    = C.CSTM_NO
         AND      D.UNMB_NO    = B.UNMB_NO
         AND      A.LN_CNTR_NO = G.LN_CNTR_NO(+)
         AND      A.LN_RPYM_SEQ = G.LN_RPYM_SEQ(+)
         AND      A.LN_RPYM_VLDY_YN = 'Y'
         AND      G.VLDY_YN(+) = 'Y'
         AND      D.LN_SCD     IN ('0003','0004','0010') /* 융자상태 - 정상, 이관, 상환완료 */
         AND      D.VLDY_YN    = 'Y' /* 유효여부 */
         AND      D.LN_GDS_CD  = E.GDS_CD
         AND      E.GDS_CLSF_CD = '0003' /*상품분류 -융자*/
         AND      D.JB_BRNC_CD = F.ENFC_CODE
         AND      A.LN_CNTR_NO = #lnCntrNo# /* 융자번호     */
		]]>
    </select>

	
    <select id="retrieveClclStrtDt" resultClass="String">
       <![CDATA[
			SELECT  /* SQL_ID : Qblo102x_01DAO.retrieveClclStrtDt  */
					TO_CHAR(TO_DATE(CLCL_END_DT,'YYYYMMDD'),'YYYYMMDD') AS clclStrtDt
			FROM (
			        SELECT MAX(NVL(B.CLCL_END_DT,A.RPYM_FXDT_DT)) AS CLCL_END_DT
			        FROM   BLO102X A
			              ,BLO103X B
			        WHERE A.LN_CNTR_NO = #lnCntrNo#
			        AND   A.LN_RPYM_VLDY_YN = 'Y'
			        AND   A.LN_CNTR_NO = B.LN_CNTR_NO(+)
			        AND   A.RPYM_FXDT_DT <= #clclStrtDt#
			        AND   B.INTR_DCD(+) = '0003'
			        AND   B.LN_INTR_VLDY_YN(+) = 'Y'
			)
		]]>
    </select>
</sqlMap>